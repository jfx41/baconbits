#!/bin/bash

# Use $HOME for the base directory
if [ -z $BACONBITS_DIR ]
then
	BACONBITS_DIR=$HOME/.baconbits
fi

#
# Initialize and install BaconBits
#
function bb_init {
	echo "Beginning BaconBits initialization ..."
	# If the base directory doesn't exist, create it
	if [ ! -d $BACONBITS_DIR ]
	then
		printf "\t* Creating: $BACONBITS_DIR\n"
		mkdir $BACONBITS_DIR
	fi

	# We will try and gracefully handle partially initialized directories
	for dir in $BACONBITS_DIRS
	do
		dir2=$BACONBITS_DIR/$dir
		if [ ! -d $dir2 ]
		then
			printf "\t\t* $dir2"
			mkdir -p $dir2
		fi
		echo
	done

	# BaconBits hasn't been installed yet or is partially installed
	if [ ! -d $BACONBITS_SHARE -o ! -f $BACONBITS_BIN ]
	then
		printf "\t* Installing BaconBits binary to: /usr/bin/baconbits\n"
		sudo cp baconbits $BACONBITS_BIN

		# Share directory doesn't exist
		if [ ! -d $BACONBITS_SHARE ]
		then
			printf "\t* Creating BaconBits share directory: $BACONBITS_SHARE\n"
			sudo mkdir $BACONBITS_SHARE
		fi

		# Copy the lib directory
		printf "\t* Installing BaconBits libraries to: $BACONBITS_SHARE/lib\n"
		sudo cp -rf lib/ $BACONBITS_SHARE
	fi

	echo "Finished initialization."

	exit 0
}

# EOF
